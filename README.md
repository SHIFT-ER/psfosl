# Приложение для автоматизации создания отчётов строительной лаборатории

Приложение на Python с использованием PyQt6 для автоматизации создания отчётов строительной лаборатории.

## Требования

- Python 3.8+
- PyQt6
- openpyxl
- SQLite3 (входит в стандартную библиотеку Python)

## Установка

1. Установите зависимости:
```bash
pip install -r requirements.txt
```

2. Убедитесь, что файл шаблона `gidroisolation_top.xlsx` находится в корневой папке проекта (опционально, если его нет, будет создан пустой файл).

## Запуск

```bash
python main.py
```

## Использование

### Авторизация

По умолчанию создаётся администратор:
- Логин: `admin`
- Пароль: `admin`

### Роли пользователей

- **Администратор** - имеет доступ ко всем разделам:
  - Управление объектами
  - Управление приборами
  - Управление пользователями
  - Управление изображениями
  - Создание отчётов

- **Пользователь** - имеет доступ только к:
  - Создание отчётов

### Управление объектами

Добавление, редактирование и удаление объектов строительства. Каждый объект содержит:
- Название
- Адрес
- Описание

### Управление приборами

Добавление, редактирование и удаление приборов. Каждый прибор содержит:
- Название
- Модель
- Инвентарный номер
- Дата действительности
- Описание

### Управление пользователями

Добавление, редактирование и удаление пользователей системы. Каждый пользователь содержит:
- ФИО
- Логин
- Пароль
- Роль (admin/user)
- Должность

### Управление изображениями

Добавление, редактирование и удаление изображений для отчётов. Изображения автоматически копируются в папку `images/<тип испытания>/`.

Для правильной работы отчётов необходимо добавить:
- Изображение шапки организации (название должно содержать "шапка", "организации" или "header")
- Изображение формулы (название должно содержать "формул" или "formula")

### Создание отчёта

1. Выберите тип испытания (пока только "Гидроизоляция")
2. Выберите объект из базы данных
3. Выберите прибор из базы данных
4. Заполните все обязательные поля:
   - Имя файла отчёта
   - Название страницы
   - Заказчик
   - Договор
   - Расположение контролируемого участка
   - Дата проведения работ
   - Название слоя
   - Площадь отрыва, см²
   - Значения силы, кН (через запятую)
   - Должность и ФИО составителя отчёта
5. Нажмите "Создать отчёт"

Отчёт будет сохранён на рабочем столе.

## Структура проекта

```
.
├── main.py                      # Главный файл приложения
├── database.py                  # Работа с базой данных SQLite
├── betta_gidroisolation.py     # Класс для создания отчётов
├── login.ui                     # UI файл окна авторизации
├── main_window.ui               # UI файл главного окна
├── objects_management.ui        # UI файл управления объектами
├── devices_management.ui        # UI файл управления приборами
├── users_management.ui          # UI файл управления пользователями
├── images_management.ui         # UI файл управления изображениями
├── create_report.ui             # UI файл создания отчёта
├── object_dialog.ui             # UI файл диалога объекта
├── device_dialog.ui             # UI файл диалога прибора
├── user_dialog.ui               # UI файл диалога пользователя
├── image_dialog.ui              # UI файл диалога изображения
├── laboratory.db                # База данных SQLite (создаётся автоматически)
├── images/                      # Папка с изображениями (создаётся автоматически)
│   └── Гидроизоляция/
└── requirements.txt             # Зависимости проекта
```

## База данных

Приложение использует SQLite для хранения данных. База данных создаётся автоматически при первом запуске.

Таблицы:
- `objects` - объекты строительства
- `devices` - приборы
- `users` - пользователи системы
- `images` - изображения для отчётов

## Примечания

- Приложение кроссплатформенное (Windows, macOS, Linux)
- Все пути к файлам обрабатываются независимо от операционной системы
- Изображения автоматически копируются в папку `images/<тип испытания>/` при добавлении
- Отчёты сохраняются на рабочем столе пользователя
- Для создания отчётов необходим файл шаблона `gidroisolation_top.xlsx` (опционально)

## Лицензия

Этот проект создан для курсовой работы.

